# 이상현상이란?
    잘못 설계된 테이블로 인해 삽입, 삭제, 수정 같은 데이터 조작시 이상현상이 발생하는 것

    예를 들어, 데이터 삽입시 NULL 값이 입력되거나, 삭제 시 연쇄삭제가 발생하거나, 수정 시 일부데이터가 훼손되는 것

# 함수 종속성이란?
    이상현상이 발생하는 테이블을 수정하여 정상으로 만드는 과정을 정규화라고 함

    정규화를 하기 위해서는 테이블을 분석하여 기본키와 함수 종속성을 파악해야 함

    속성 A 값을 알면 다른 속성 B의 값이 유일하게 정해지는 의존 관계를
    속성 B는 속성 A에 종속한다 또는 속성 A는 속성 B를 결정한다 라고 표현함

    즉, A는 B의 결정자임

    마찬가지로 수학에서 변수 x와 y사이에 x의 값이 정해지면 y의 값이 정해지는 관계를
    y는 x의 함수라고 표현함

    이를 테이블의 속성간의 관계에 적용시키면 왼쪽 속성의 모든 값에 대하여 오른쪽 속성의 값이 유일하게 결정될 때
    '함수적으로 종속한다' 라고 표현하고, 릴레이션의 속성 간에 함수적으로 종속하는 성질을 '함수 종속성' 이라고 함

# 함수 종속성 규칙 
![image](https://github.com/user-attachments/assets/fda0f3a8-6bbc-45b1-b5a2-d236b990656a)

# 함수 종속성의 기본키
    함수 종속성을 파악하기 위해서는 우선 기본키를 찾아야함

    왜냐하면 릴레이션에서 기본키 값은 유일하기 때문에, 릴레이션의 모든 속성에 대한 결정자가 될 수 있기 때문

    아래 이미지를 예시로 보자면, 이름이 같은 학생이 없고 이름 속성이 해당 릴레이션의 기본키라고 할때,
    
    (이름 -> 학과 / 이름 -> 주소 / 이름 -> 취득학점)이 성립하므로, 
    (이름 -> 이름, 학과, 주소, 취득학점) 또한 성립함을 알 수 있음

    즉, 이름 속성(기본키)가 릴레이션의 전체를 결정함
    
![image](https://github.com/user-attachments/assets/7301565f-28c0-405f-b795-b00439adb7d3)

# 이상현상과 결정자
    이상현상은 한 개의 릴레이션에 두 개 이상의 정보가 포함되어 있을때 나타남

    아래 릴레이션의 경우,
    
    학생 정보(학생번호, 학생이름, 주소, 학과)와 강좌정보(강좌이름, 강의실)가 
    한 릴레이션에 포함되어 있기 때문에 이상현상이 발생함

    좀더 자세히 들여다보면, 
    아래 릴레이션에서 결정자는 (학생번호, 강좌이름), (학생번호, 강좌이름, 학과)이 있음

    여기서 (학생번호, 강좌이름)은 기본키이면서 결정자이지만, (학생번호, 강좌이름, 학과)는 기본키가 아니면서 결정자임
    
    즉, 이상현상은 기본키가 아니면서 결정자인 속성이 있을때 발생함

![image](https://github.com/user-attachments/assets/398ea13d-960c-4310-9955-604d685aaf7f)
![image](https://github.com/user-attachments/assets/30d64e6e-9551-4451-83df-e237ced8a60a)    

# 이상현상 해결
    아래와 같이 릴레이션을 분해하여 문제를 해결할 수 있음
    
    학생 릴레이션(학생번호, 학생이름, 학과 주소), 
    학과 릴레이션(학과, 학과사무실), 
    학생성적 릴레이션(학생번호, 강좌이름, 성적), 
    강의실 릴레이션(강좌이름, 강의실)
    
![image](https://github.com/user-attachments/assets/c3ac1069-5474-476e-95c0-2c527a7b77fd)

# 정규화
    이상현상에는 여러 가지가 존재하는데, 대대분이 두 개 이상의 정보가 한 릴레이션에 들어가 있어서 발생함
    발생한 이상현상은 이상현상이 없어질 때까지 릴레이션을 분해하여 해결함

    이렇듯 이상현상이 발생하는 릴레이션을 분해하여 이상현상을 없애는 과정을 정규화라고 함

# 정규화 과정
    1. 제1 정규형
       " 릴레이션의 모든 속성값이 원자값(더 이상 쪼갤 수 없는 값)이어야 한다 "
![image](https://github.com/user-attachments/assets/1a3b0256-3bd6-4d7f-afa1-3333e6b91632)

    2. 제2 정규형
       " 릴레이션이 제1 정규형이고, 기본키가 아닌 속성이 기본키에 완전 함수 종속이어야 한다 "

       여기서 완전 함수 종속이란,
       A -> B 종속성에서 A의 속성 일부를 제거해도 종속성이 여전히 성립하는 경우가 없어야 함

       예를 들어 (A1, A2) -> B 종속성에서 A2를 제거했는데도 A1 -> B가 성립하면 불완전 함수 종속

       아래 릴레이션을 보면,
       성적, 강의실 모두 기본키(학생번호, 강좌이름)에 종속되어 있지만,
       강의실의 경우 기본키의 일부(부분집합)인 강좌이름에 한 번 더 종속되어 있음

       즉, 기본키가 아닌 속성이 기본키에 불완전 함수 종속함

       이와 관련하여 발생할 수 있는 이상현상으로는 크게 3가지가 있음

       첫 째, 삭제이상
       402번 학생이 수강을 취소하면 스포츠경영학 과목의 강의실에 대한 정보가 사라짐
       둘 째, 삽입이상
       컴퓨터입문 과목이 개설되어 공학관 112호를 사용하게 되었는데, 아직 과목을 신청한 학생이 없을 경우 학생번호와 성적이 NULL이 됨
       셋 째, 수정이상
       데이터베이스 강의실을 공학관 113호로 변경할 경우 데이터 불일치가 발생함
![image](https://github.com/user-attachments/assets/72117ed7-a1a8-4c16-a7d6-6412ddcd0870)

    이를 해결하기 위해서는 아래와 같이 릴레이션을 분해해야하고, 
    아래와 같이 분해된 릴레이션은 제2 정규형을 만족하고 있다고 할 수 있음
![image](https://github.com/user-attachments/assets/6bb7c6da-d405-46d9-8aad-b6359f87bcca)

    3. 제3 정규형
       " 릴레이션이 제2 정규형이고, 기본키가 아닌 속성이 기본키에 비이행적으로 종속해야한다"

       여기서 이행 종속이란 A -> B, B -> C 일 때, A -> C 가 성립하는 함수 종속성을 의미함

       아래 릴레이션을 보면,
       기본키가 아닌 강좌이름이 수강료를 결정하고 있음
       다시 말해, 기본키가 아닌 속성(강좌이름)이 기본키가 아닌 다른 속성(수강료)를 결정하고 있음

       즉, A(학생번호) -> B(강좌이름), B(강좌이름) -> C(수강료) --> A -> C(수강료)로,
       수강료는 기본키에 이행종속 되고 있음

       이와 관련하여 발생할 수 있는 이상현상으로는 크게 3가지가 있음

       첫 째, 삭제이상
       402번 학생이 수강을 취소하면 스포츠경영학 과목의 수강료에 대한 정보가 사라짐
       둘 째, 삽입이상
       컴퓨터입문 과목이 개설되어 수강료 15000원을 삽입해야하는데, 아직 신청한 학생이 없어 학생번호가 NULL이 됨
       셋 째, 수정이상
       데이터베이스 수강료를 15000원으로 수정할 경우 데이터 불일치가 발생함
![image](https://github.com/user-attachments/assets/1913f75f-5be2-45a5-9a76-72e5da3d350e)

       이를 해결하기 위해서는 아래와 같이 릴레이션을 분해해야하고,
       아래와 같이 분해된 릴레이션은 제 3 정규형을 만족하고 있다고 할 수 있음

![image](https://github.com/user-attachments/assets/0aa7f696-9b24-4970-a253-f8d8ef0d09ca)

    4. BCNF
       " 릴레이션에 존재하는 함수 종속성에서 모든 결정자가 후보키이여야 한다 "

       해당 개념은 예시를 통해 이해하는 것이 빠르므로, 아래 릴레이션을 참고함
       (단, 릴레이션에서 교수는 하나의 특강만을 담당함)

       아래 릴레이션을 보면,
       기본키가 (학생번호, 특강이름) 이고, 
       (학생번호, 특강이름) -> 교수, 교수 -> 특강이름의 함수 종속성이 존재함

       여기서 (학생번호, 특강이름)은 후보키이지만, 교수 속성은 후보키가 아님
       (만약, 교수 속성이 기본키가 된다면 투플을 유일하게 식별할 수가 없음, 따라서 후보키가 아님)
![image](https://github.com/user-attachments/assets/4587d876-5a66-4154-8066-df6c57f1ca4b)

       이를 해결하기 위해서는 아래와 같이 릴레이션을 분해해야하고,
       아래와 같이 분해된 릴레이션은 BCNF 정규형 만족하고 있다고 할 수 있음
![image](https://github.com/user-attachments/assets/78b2df3c-504a-4082-bdc4-16dbdb1e8d7b)
       
# 무손실 분해 규칙
    정규화는 릴레이션을 분해하여 이상현상을 제거하는 과정임

    그리고 릴레이션을 분해할 때는 반드시 분해된 릴레이션 간에 공통 속성을 한 개 이상 두어,
    분해된 릴레이션을 다시 원래의 릴레이션으로 돌릴 때 사용할 수 있어야함

    무손실 분해 규칙을 지키기 위해서는 
    " 릴레이션 R을 릴레이션 R1과 R2로 분해할 때, 공통 속성이 반드시 한 쪽 릴레이션의 기본키가 되어야한다 "
    라는 조건을 만족해야 함

    그동안 위의 예시에 보았던 정규화를 거친 릴레이션들을 다시보고
    분해된 릴레이션에 공통으로 존재하는 속성이 한 쪽 릴레이션의 기본키가 되고 있는지를 다시 한 번 확인해보자
    
# 정규화 더 알아보기
    정규화는 릴레이션의 분해를 통해 이루어지는데,
    여기서 주목할 점은 릴레이션을 분해하여 만든 다른 릴레이션이 반드시 다음 정규형을 만족하지는 않는다는 것임
    더 높은 정규형을 만족할 수도 있음

    릴레이션 분해로 인한 JOIN 연산이 많아져 질의에 대한 응답시간이 느려짐. 
    하지만 동시에 중복속성을 제거하고 테이블의 데이터 용량이 최소화 되는 효과가 있어 속도가 빨라질 수도, 느려질 수도 있음.
